<root main_tree_to_execute="MainTree">
  <BehaviorTree ID="MainTree">

    <Fallback name="FollowOrRecover">

      <!-- Try to follow the precomputed SpiralSTC path -->
      <FollowPath path="{spiral_path}" controller_id="FollowPath"/>

      <!-- If blocked, do recovery and rejoin path -->
      <Sequence name="RecoveryIfBlocked">
        <GetRobotPose output="{current_pose}"/>
        <FindUnoccupiedWaypoint path="{spiral_path}" pose="{current_pose}" output="{rejoin_point}"/>
        <ComputePathToPose goal="{rejoin_point}" path="{recovery_path}" planner_id="GridBased"/>
        <FollowPath path="{recovery_path}" controller_id="FollowPath"/>
      </Sequence>

    </Fallback>

  </BehaviorTree>
</root>